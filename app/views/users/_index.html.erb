<script type="text/javascript">
  $(document).ready(function() {
    $('.datatable').dataTable({
      "oLanguage": {
        "sLengthMenu": "每页条数:_MENU_",
        "sZeroRecords": "抱歉， 没有找到",
        "sSearch": "搜素:",
        "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
        "sInfoEmpty": "没有数据",
        "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
        "oPaginate": {
        "sFirst": "首页",
        "sPrevious": "前一页",
        "sNext": "后一页",
        "sLast": "尾页"
        }
      }  
    });
  });
</script>
<%= render 'shared/notice' %>
<div>
  <%= render 'shared/new_button', path: new_user_path, name: "新用户" %>
</div>
<div id="users-table">
  <table class="table table-hover">
    <thead>
      <tr>
        <th>用户名</th>
        <th>所属机构</th>
        <th>部门</th>
        <th>角色</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= link_to user.username, edit_user_path(id: user.id, from: "edit"), remote: true %></td>
          <td><%= user.agency.name %></td>
          <td><%= user.department.nil?? "" : user.department.name %></td>
          <td>
            <%= user.roles.map { |role| "#{role.name}" }.join(',') %>
          </td>
          <td><%= link_to 'Destroy', user, method: :delete, remote: true,
            data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>